{% extends 'bootstrapTemplate/base.html' %}
{% load static %}

{% block content %}
<!--**********************************
    Content body start
***********************************-->
<div class="content-body">

    <div class="row page-titles mx-0">
        <div class="col p-md-0">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="javascript:void(0)">Dashboard</a></li>
                <li class="breadcrumb-item active"><a href="javascript:void(0)">Home</a></li>
            </ol>
        </div>
    </div>
    <!-- row -->
    

    <div class="container-fluid">
        <!-- End Row -->
        <div class="row">
            <div class="col-12 m-b-30">
                <h4 class="d-inline">Weekly Schedule</h4>
                <p class="text-muted">Your weekly todo</p>

                <div class="row">
                    <style>
                        .todo-table::-webkit-scrollbar {
                            /*width: 10px;*/
                            display:none;
                        }
                    </style>

                    <!-- *********MONDAY********* -->

                    <div class="col-md-6 col-lg-3">
                        <div class="card">
                            <div class="card-header bg-white">
                                <table>
                                    <tr>
                                        <td rowspan="2" class="card-title text-center pr-3"><h2>{{ week.mon }}</h2></td>
                                        <td class="font-weight-semi-bold">{{ month.mon }}</td>
                                        <td rowspan="2" class="font-weight-semi-bold text-right w-100"><h5 class="text-muted">MONDAY</h5></td>
                                    </tr>
                                    <tr>
                                        <td class="font-weight-normal">2020</td>
                                    </tr>
                                </table>
                            </div>

                            <div class="w-100 pl-3 pr-1 pt-1 card-body todo-table" style="overflow-y: auto; height: 280px;">
                                <table class="table" id="todo-table-mon">
                                    <tbody>
                                    {% include 'todo/monday_todo_list.html' %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="card-footer text-center">
                                <button type="button" class="btn mb-1 btn-rounded btn-outline-secondary js-create-todo-mon" data-id="mon" data-url="{% url 'todo_create' day='mon' %}">Add Todo<span class="btn-icon-right"><i class="fa fa-plus"></i></span></button>
                            </div>
                        </div>
                        <div class="modal fade" id="modal-todo-mon">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- End MONDAY -->

                    <!-- ********* TUESDAY ********* -->
                    <div class="col-md-6 col-lg-3">
                        <div class="card">
                            <div class="card-header bg-white">
                                <table>
                                    <tr>
                                        <td rowspan="2" class="card-title text-center pr-3"><h2>{{ week.tue }}</h2></td>
                                        <td class="font-weight-semi-bold">{{ month.tue }}</td>
                                        <td rowspan="2" class="font-weight-semi-bold text-right w-100"><h5 class="text-muted">TUESDAY</h5></td>
                                    </tr>
                                    <tr>
                                        <td class="font-weight-normal">2020</td>
                                    </tr>
                                </table>
                            </div>

                            <div class="w-100 pl-3 pr-1 pt-1 card-body todo-table" style="overflow-y: auto; height: 280px;">
                                <table class="table" id="todo-table-tue">
                                    <tbody>
                                    {% include 'todo/tuesday_todo_list.html' %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="card-footer text-center">
                                <button type="button" class="btn mb-1 btn-rounded btn-outline-secondary js-create-todo-tue" data-id="tue" data-url="{% url 'todo_create' day='tue' %}">Add Todo<span class="btn-icon-right"><i class="fa fa-plus"></i></span></button>
                            </div>
                        </div>
                        <div class="modal fade" id="modal-todo-tue">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- End TUESDAY -->

                    <!-- ********* WEDNESDAY ********* -->
                    <div class="col-md-6 col-lg-3">
                        <div class="card">
                            <div class="card-header bg-white">
                                <table>
                                    <tr>
                                        <td rowspan="2" class="card-title text-center pr-3"><h2>{{ week.wed }}</h2></td>
                                        <td class="font-weight-semi-bold">{{ month.wed }}</td>
                                        <td rowspan="2" class="font-weight-semi-bold text-right w-100"><h5 class="text-muted">WEDNESDAY</h5></td>
                                    </tr>
                                    <tr>
                                        <td class="font-weight-normal">2020</td>
                                    </tr>
                                </table>
                            </div>
                            <div class="w-100 pl-3 pr-1 pt-1 card-body todo-table" style="overflow-y: auto; height: 280px;">
                                <table class="table" id="todo-table-wed">
                                    <tbody>
                                    {% include 'todo/wednesday_todo_list.html' %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="card-footer text-center">
                                <button type="button" class="btn mb-1 btn-rounded btn-outline-secondary js-create-todo-wed" data-id="wed" data-url="{% url 'todo_create' day='wed' %}">Add Todo<span class="btn-icon-right"><i class="fa fa-plus"></i></span></button>
                            </div>
                        </div>
                        <div class="modal fade" id="modal-todo-wed">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- End WEDNESDAY -->

                    <!-- ********* THURSDAY ********* -->
                    <div class="col-md-6 col-lg-3">
                        <div class="card">
                            <div class="card-header bg-white">
                                <table>
                                    <tr>
                                        <td rowspan="2" class="card-title text-center pr-3"><h2>{{ week.thu }}</h2></td>
                                        <td class="font-weight-semi-bold">{{ month.thu }}</td>
                                        <td rowspan="2" class="font-weight-semi-bold text-right w-100"><h5 class="text-muted">THURSDAY</h5></td>
                                    </tr>
                                    <tr>
                                        <td class="font-weight-normal">2020</td>
                                    </tr>
                                </table>
                            </div>
                            <div class="w-100 pl-3 pr-1 pt-1 card-body todo-table" style="overflow-y: auto; height: 280px;">
                                <table class="table" id="todo-table-thu">
                                    <tbody>
                                    {% include 'todo/thursday_todo_list.html' %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="card-footer text-center">
                                <button type="button" class="btn mb-1 btn-rounded btn-outline-secondary js-create-todo-thu" data-id="thu" data-url="{% url 'todo_create' day='thu' %}">Add Todo<span class="btn-icon-right"><i class="fa fa-plus"></i></span></button>
                            </div>
                        </div>
                        <div class="modal fade" id="modal-todo-thu">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- End THURSDAY -->

                    <!-- ********* FRIDAY ********* -->
                    <div class="col-md-6 col-lg-3">
                        <div class="card">
                            <div class="card-header bg-white">
                                <table>
                                    <tr>
                                        <td rowspan="2" class="card-title text-center pr-3"><h2>{{ week.fri }}</h2></td>
                                        <td class="font-weight-semi-bold">{{ month.fri }}</td>
                                        <td rowspan="2" class="font-weight-semi-bold text-right w-100"><h5 class="text-muted">FRIDAY</h5></td>
                                    </tr>
                                    <tr>
                                        <td class="font-weight-normal">2020</td>
                                    </tr>
                                </table>
                            </div>
                           <div class="w-100 pl-3 pr-1 pt-1 card-body todo-table" style="overflow-y: auto; height: 280px;">
                                <table class="table" id="todo-table-fri">
                                    <tbody>
                                    {% include 'todo/friday_todo_list.html' %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="card-footer text-center">
                                <button type="button" class="btn mb-1 btn-rounded btn-outline-secondary js-create-todo-fri" data-id="fri" data-url="{% url 'todo_create' day='fri' %}">Add Todo<span class="btn-icon-right"><i class="fa fa-plus"></i></span></button>
                            </div>
                        </div>
                        <div class="modal fade" id="modal-todo-fri">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- End FRIDAY -->

                    <!-- ********* SATURDAY ********* -->
                    <div class="col-md-6 col-lg-3">
                        <div class="card">
                            <div class="card-header bg-white">
                                <table>
                                    <tr>
                                        <td rowspan="2" class="card-title text-center pr-3"><h2 class="text-info">{{ week.sat }}</h2></td>
                                        <td class="font-weight-semi-bold">{{ month.sat }}</td>
                                        <td rowspan="2" class="font-weight-semi-bold text-right w-100"><h5 class="text-muted">SATURDAY</h5></td>
                                    </tr>
                                    <tr>
                                        <td class="font-weight-normal">2020</td>
                                    </tr>
                                </table>
                            </div>
                            <div class="w-100 pl-3 pr-1 pt-1 card-body todo-table" style="overflow-y: auto; height: 280px;">
                                <table class="table" id="todo-table-sat">
                                    <tbody>
                                    {% include 'todo/saturday_todo_list.html' %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="card-footer text-center">
                                <button type="button" class="btn mb-1 btn-rounded btn-outline-secondary js-create-todo-sat" data-id="sat" data-url="{% url 'todo_create' day='sat' %}">Add Todo<span class="btn-icon-right"><i class="fa fa-plus"></i></span></button>
                            </div>
                        </div>
                        <div class="modal fade" id="modal-todo-sat">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- End SATURDAY -->

                    <!-- ********* SUNDAY ********* -->

                    <div class="col-md-6 col-lg-3">
                        <div class="card">
                            <div class="card-header bg-white">
                                <table>
                                    <tr>
                                        <td rowspan="2" class="card-title text-center pr-3"><h2 class="text-danger">{{ week.sun }}</h2></td>
                                        <td class="font-weight-semi-bold">{{ month.sun }}</td>
                                        <td rowspan="2" class="font-weight-semi-bold text-right w-100"><h5 class="text-muted">SUNDAY</h5></td>
                                    </tr>
                                    <tr>
                                        <td class="font-weight-normal">2020</td>
                                    </tr>
                                </table>
                            </div>
                                <div class="w-100 pl-3 pr-1 pt-1 card-body todo-table" style="overflow-y: auto; height: 280px;">
                                <table class="table" id="todo-table-sun">
                                    <tbody>
                                    {% include 'todo/sunday_todo_list.html' %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="card-footer text-center">
                                <button type="button" class="btn mb-1 btn-rounded btn-outline-secondary js-create-todo-sun" data-id="sun" data-url="{% url 'todo_create' day='sun' %}">Add Todo<span class="btn-icon-right"><i class="fa fa-plus"></i></span></button>
                            </div>
                        </div>
                        <div class="modal fade" id="modal-todo-sun">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end SUNDAY -->
                </div>
            </div>
        </div>

    </div>
    <!-- #/ container -->
</div>

<!--**********************************
    Content body end
***********************************-->


<!--**********************************
     javascript start
***********************************-->
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script type="text/javascript">

    // todo완료
    $("body").delegate('.complete-todo','click',function(){

            pk = $(this).attr("data-id");
            $.ajax({
                type:"POST",
                url: $(this).attr("data-url"),
                data: {'csrfmiddlewaretoken':'{{ csrf_token }}'},
                dataType: "json",
                success: function(data){
                    if (data.completed){
                        $(this).attr('checked', true);
                        $('#todo-title-'+pk).css('text-decoration','line-through')
                    }
                    else{
                        $(this).attr('checked', false);
                        $('#todo-title-'+pk).css('text-decoration','none')
                    }

                }
            });
    });

    // todo삭제
    $("body").delegate('.js-delete-todo','click',function(){
        pk = $(this).attr("data-id");
        $.ajax({
            type:"POST",
            url: $(this).attr("data-url"),
            data: {'csrfmiddlewaretoken':'{{ csrf_token }}'},
            dataType: "json",
            success: function(data){
                if(data.delete_success){
                    $('#todo-tr-'+pk).remove();
                }
            }
        });
    });

    //월요일todo-modal오픈
    $(".js-create-todo-mon").click(function(){
        var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#modal-todo-mon").modal("show");
                },
                success: function (data) {
                    $("#modal-todo-mon .modal-content").html(data.html_form);
                }
            });
    })

    //월요일todo-add
     $("#modal-todo-mon").on("submit", ".js-todo-create-form", function(){
         var form = $(this);
            $.ajax({
                url: form.attr("action"),
                data: form.serialize(),
                type: form.attr("method"),
                dataType: 'json',
                success: function (data) {
                    if (data.form_is_valid) {
                        $("#modal-todo-mon").modal("hide");
                        $("#todo-table-mon tbody").append(data.added_todo)
                    }
                    else {
                        $("#modal-todo-mon .modal-content").html(data.html_form);
                    }
                }
            });
            return false;
     });

    //화요일todo-modal오픈
    $(".js-create-todo-tue").click(function(){
        var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#modal-todo-tue").modal("show");
                },
                success: function (data) {
                    $("#modal-todo-tue .modal-content").html(data.html_form);
                }
            });
    })

    //화요일todo-add
     $("#modal-todo-tue").on("submit", ".js-todo-create-form", function(){
         var form = $(this);
            $.ajax({
                url: form.attr("action"),
                data: form.serialize(),
                type: form.attr("method"),
                dataType: 'json',
                success: function (data) {
                    if (data.form_is_valid) {
                        $("#modal-todo-tue").modal("hide");
                        $("#todo-table-tue tbody").append(data.added_todo)
                    }
                    else {
                        $("#modal-todo-tue .modal-content").html(data.html_form);
                    }
                }
            });
            return false;
     });

    //수요일todo-modal오픈
    $(".js-create-todo-wed").click(function(){
        var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#modal-todo-wed").modal("show");
                },
                success: function (data) {
                    $("#modal-todo-wed .modal-content").html(data.html_form);
                }
            });
    })

    //수요일todo-add
     $("#modal-todo-wed").on("submit", ".js-todo-create-form", function(){
         var form = $(this);
            $.ajax({
                url: form.attr("action"),
                data: form.serialize(),
                type: form.attr("method"),
                dataType: 'json',
                success: function (data) {
                    if (data.form_is_valid) {
                        $("#modal-todo-wed").modal("hide");
                        $("#todo-table-wed tbody").append(data.added_todo)
                    }
                    else {
                        $("#modal-todo-wed .modal-content").html(data.html_form);
                    }
                }
            });
            return false;
     });

    //목요일todo-modal오픈
    $(".js-create-todo-thu").click(function(){
        var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#modal-todo-thu").modal("show");
                },
                success: function (data) {
                    $("#modal-todo-thu .modal-content").html(data.html_form);
                }
            });
    })

    //목요일todo-add
     $("#modal-todo-thu").on("submit", ".js-todo-create-form", function(){
         var form = $(this);
            $.ajax({
                url: form.attr("action"),
                data: form.serialize(),
                type: form.attr("method"),
                dataType: 'json',
                success: function (data) {
                    if (data.form_is_valid) {
                        $("#modal-todo-thu").modal("hide");
                        $("#todo-table-thu tbody").append(data.added_todo)
                    }
                    else {
                        $("#modal-todo-thu .modal-content").html(data.html_form);
                    }
                }
            });
            return false;
     });

    //금요일todo-modal오픈
    $(".js-create-todo-fri").click(function(){
        var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#modal-todo-fri").modal("show");
                },
                success: function (data) {
                    $("#modal-todo-fri .modal-content").html(data.html_form);
                }
            });
    })

    //금요일todo-add
     $("#modal-todo-fri").on("submit", ".js-todo-create-form", function(){
         var form = $(this);
            $.ajax({
                url: form.attr("action"),
                data: form.serialize(),
                type: form.attr("method"),
                dataType: 'json',
                success: function (data) {
                    if (data.form_is_valid) {
                        $("#modal-todo-fri").modal("hide");
                        $("#todo-table-fri tbody").append(data.added_todo)
                    }
                    else {
                        $("#modal-todo-fri .modal-content").html(data.html_form);
                    }
                }
            });
            return false;
     });

    //토요일todo-modal오픈
    $(".js-create-todo-sat").click(function(){
        var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#modal-todo-sat").modal("show");
                },
                success: function (data) {
                    $("#modal-todo-sat .modal-content").html(data.html_form);
                }
            });
    })

    //토요일todo-add
     $("#modal-todo-sat").on("submit", ".js-todo-create-form", function(){
         var form = $(this);
            $.ajax({
                url: form.attr("action"),
                data: form.serialize(),
                type: form.attr("method"),
                dataType: 'json',
                success: function (data) {
                    if (data.form_is_valid) {
                        $("#modal-todo-sat").modal("hide");
                        $("#todo-table-sat tbody").append(data.added_todo)
                    }
                    else {
                        $("#modal-todo-sat .modal-content").html(data.html_form);
                    }
                }
            });
            return false;
     });

    //일요일todo-modal오픈
    $(".js-create-todo-sun").click(function(){
        var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#modal-todo-sun").modal("show");
                },
                success: function (data) {
                    $("#modal-todo-sun .modal-content").html(data.html_form);
                }
            });
    })

    //일요일todo-add
     $("#modal-todo-sun").on("submit", ".js-todo-create-form", function(){
         var form = $(this);
            $.ajax({
                url: form.attr("action"),
                data: form.serialize(),
                type: form.attr("method"),
                dataType: 'json',
                success: function (data) {
                    if (data.form_is_valid) {
                        $("#modal-todo-sun").modal("hide");
                        $("#todo-table-sun tbody").append(data.added_todo)
                    }
                    else {
                        $("#modal-todo-sun .modal-content").html(data.html_form);
                    }
                }
            });
            return false;
     });

</script>
<!--**********************************
     javascript end
***********************************-->
{% endblock %}