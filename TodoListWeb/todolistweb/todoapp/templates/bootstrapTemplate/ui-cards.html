{% extends 'bootstrapTemplate/base.html' %}
{% load static %}

{% block content %}
<!--**********************************
    Content body start
***********************************-->
<div class="content-body">

    <div class="row page-titles mx-0">
        <div class="col p-md-0">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="javascript:void(0)">Dashboard</a></li>
                <li class="breadcrumb-item active"><a href="javascript:void(0)">Home</a></li>
            </ol>
        </div>
    </div>
    <!-- row -->

    <div class="container-fluid">
        <!-- End Row -->
        <div class="row">
            <div class="col-12 m-b-30">
                <h4 class="d-inline">Weekly Schedule</h4>
                <p class="text-muted">Your weekly todo</p>

                <div class="row">

                    <!-- *********MONDAY********* -->

                    <div class="col-md-6 col-lg-3">
                        <div class="card">
                            <div class="card-header bg-white">
                                <table>
                                    <tr>
                                        <td rowspan="2" class="card-title text-center pr-3"><h2>{{ week.mon }}</h2></td>
                                        <td class="font-weight-semi-bold">{{ month.mon }}</td>
                                        <td rowspan="2" class="font-weight-semi-bold text-right w-100"><h5 class="text-muted">MONDAY</h5></td>
                                    </tr>
                                    <tr>
                                        <td class="font-weight-normal">2020</td>
                                    </tr>
                                </table>
                            </div>

                            <div class="w-100 pl-3 pr-1 pt-1 card-body" style="overflow-y: auto; height: 280px;">
                                <table class="table" id="todo-table-mon">
                                    <tbody>
                                    {% include 'todo/monday_todo_list.html' %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="card-footer text-center">
                                <button type="button" class="btn mb-1 btn-rounded btn-outline-secondary js-create-todo-mon" data-id="mon" data-url="{% url 'todo_create' day='mon' %}">Add Todo<span class="btn-icon-right"><i class="fa fa-plus"></i></span></button>
                            </div>
                        </div>
                        <div class="modal fade" id="modal-todo-mon">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- End MONDAY -->

                    <!-- ********* TUESDAY ********* -->
                    <div class="col-md-6 col-lg-3">
                        <div class="card">
                            <div class="card-header bg-white">
                                <table>
                                    <tr>
                                        <td rowspan="2" class="card-title text-center pr-3"><h2>{{ week.tue }}</h2></td>
                                        <td class="font-weight-semi-bold">{{ month.tue }}</td>
                                        <td rowspan="2" class="font-weight-semi-bold text-right w-100"><h5 class="text-muted">TUESDAY</h5></td>
                                    </tr>
                                    <tr>
                                        <td class="font-weight-normal">2020</td>
                                    </tr>
                                </table>
                            </div>

                            <div class="w-100 pl-3 pr-1 pt-1 card-body" style="overflow-y: auto; height: 280px;">
                                <table class="table" id="todo-table-tue">
                                    <tbody>
                                    {% include 'todo/tuesday_todo_list.html' %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="card-footer text-center">
                                <button type="button" class="btn mb-1 btn-rounded btn-outline-secondary js-create-todo-tue" data-url="{% url 'todo_create' day='tue' %}">Add Todo<span class="btn-icon-right"><i class="fa fa-plus"></i></span></button>
                            </div>
                        </div>
                        <div class="modal fade" id="modal-todo-tue">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- End TUESDAY -->

                    <!-- ********* WEDNESDAY ********* -->
                    <div class="col-md-6 col-lg-3">
                        <div class="card">
                            <div class="card-header bg-white">
                                <table>
                                    <tr>
                                        <td rowspan="2" class="card-title text-center pr-3"><h2>{{ week.wed }}</h2></td>
                                        <td class="font-weight-semi-bold">{{ month.wed }}</td>
                                        <td rowspan="2" class="font-weight-semi-bold text-right w-100"><h5 class="text-muted">WEDNESDAY</h5></td>
                                    </tr>
                                    <tr>
                                        <td class="font-weight-normal">2020</td>
                                    </tr>
                                </table>
                            </div>
                            <div class="w-100 pl-3 pr-1 pt-1" style="overflow-y: auto; height: 280px;">
                                <table class="table" id="todo-table-wed">
                                    <tbody>
                                    {% include 'todo/wednesday_todo_list.html' %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="card-footer text-center">
                                <button type="button" class="btn mb-1 btn-rounded btn-outline-secondary js-create-todo-wed"  data-url="{% url 'todo_create' day='wed' %}">Add Todo<span class="btn-icon-right"><i class="fa fa-plus"></i></span></button>
                            </div>
                        </div>
                        <div class="modal fade" id="modal-todo-wed">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- End WEDNESDAY -->

                    <!-- ********* THURSDAY ********* -->
                    <div class="col-md-6 col-lg-3">
                        <div class="card">
                            <div class="card-header bg-white">
                                <table>
                                    <tr>
                                        <td rowspan="2" class="card-title text-center pr-3"><h2>{{ week.thu }}</h2></td>
                                        <td class="font-weight-semi-bold">{{ month.thu }}</td>
                                        <td rowspan="2" class="font-weight-semi-bold text-right w-100"><h5 class="text-muted">THURSDAY</h5></td>
                                    </tr>
                                    <tr>
                                        <td class="font-weight-normal">2020</td>
                                    </tr>
                                </table>
                            </div>
                            <div class="w-100 pl-3 pr-1 pt-1" style="overflow-y: auto; height: 280px;">
                                <table class="table" id="todo-table-thu">
                                    <tbody>
                                    {% include 'todo/thursday_todo_list.html' %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="card-footer text-center">
                                <button type="button" class="btn mb-1 btn-rounded btn-outline-secondary js-create-todo-thu" data-url="{% url 'todo_create' day='thu' %}">Add Todo<span class="btn-icon-right"><i class="fa fa-plus"></i></span></button>
                            </div>
                        </div>
                        <div class="modal fade" id="modal-todo-thu">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- End THURSDAY -->

                    <!-- ********* FRIDAY ********* -->
                    <div class="col-md-6 col-lg-3">
                        <div class="card">
                            <div class="card-header bg-white">
                                <table>
                                    <tr>
                                        <td rowspan="2" class="card-title text-center pr-3"><h2>{{ week.fri }}</h2></td>
                                        <td class="font-weight-semi-bold">{{ month.fri }}</td>
                                        <td rowspan="2" class="font-weight-semi-bold text-right w-100"><h5 class="text-muted">FRIDAY</h5></td>
                                    </tr>
                                    <tr>
                                        <td class="font-weight-normal">2020</td>
                                    </tr>
                                </table>
                            </div>
                           <div class="card-body w-100 pl-3 pr-1 pt-1" style="overflow-y: auto; height: 280px;">
                                <table class="table" id="todo-table-fri">
                                    <tbody>
                                    {% include 'todo/friday_todo_list.html' %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="card-footer text-center">
                                <button type="button" class="btn mb-1 btn-rounded btn-outline-secondary js-create-todo-fri" data-url="{% url 'todo_create' day='fri' %}">Add Todo<span class="btn-icon-right"><i class="fa fa-plus"></i></span></button>
                            </div>
                        </div>
                        <div class="modal fade" id="modal-todo-fri">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- End FRIDAY -->

                    <!-- ********* SATURDAY ********* -->
                    <div class="col-md-6 col-lg-3">
                        <div class="card">
                            <div class="card-header bg-white">
                                <table>
                                    <tr>
                                        <td rowspan="2" class="card-title text-center pr-3"><h2 class="text-info">{{ week.sat }}</h2></td>
                                        <td class="font-weight-semi-bold">{{ month.sat }}</td>
                                        <td rowspan="2" class="font-weight-semi-bold text-right w-100"><h5 class="text-muted">SATURDAY</h5></td>
                                    </tr>
                                    <tr>
                                        <td class="font-weight-normal">2020</td>
                                    </tr>
                                </table>
                            </div>
                            <div class="card-body w-100 pl-3 pr-1 pt-1" style="overflow-y: auto; height: 280px;">
                                <table class="table" id="todo-table-sat">
                                    <tbody>
                                    {% include 'todo/saturday_todo_list.html' %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="card-footer text-center">
                                <button type="button" class="btn mb-1 btn-rounded btn-outline-secondary js-create-todo-sat" data-url="{% url 'todo_create' day='sat' %}">Add Todo<span class="btn-icon-right"><i class="fa fa-plus"></i></span></button>
                            </div>
                        </div>
                        <div class="modal fade" id="modal-todo-sat">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- End SATURDAY -->

                    <!-- ********* SUNDAY ********* -->

                    <div class="col-md-6 col-lg-3">
                        <div class="card">
                            <div class="card-header bg-white">
                                <table>
                                    <tr>
                                        <td rowspan="2" class="card-title text-center pr-3"><h2 class="text-danger">{{ week.sun }}</h2></td>
                                        <td class="font-weight-semi-bold">{{ month.sun }}</td>
                                        <td rowspan="2" class="font-weight-semi-bold text-right w-100"><h5 class="text-muted">SUNDAY</h5></td>
                                    </tr>
                                    <tr>
                                        <td class="font-weight-normal">2020</td>
                                    </tr>
                                </table>
                            </div>
                                <div class="card-body w-100 pl-3 pr-1 pt-1" style="overflow-y: auto; height: 280px;">
                                <table class="table" id="todo-table-sun">
                                    <tbody>
                                    {% include 'todo/sunday_todo_list.html' %}
                                    </tbody>
                                </table>
                            </div>
                            <div class="card-footer text-center">
                                <button type="button" class="btn mb-1 btn-rounded btn-outline-secondary js-create-todo-sun" data-url="{% url 'todo_create' day='sun' %}">Add Todo<span class="btn-icon-right"><i class="fa fa-plus"></i></span></button>
                            </div>
                        </div>
                        <div class="modal fade" id="modal-todo-sun">
                            <div class="modal-dialog">
                                <div class="modal-content">

                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end SUNDAY -->
                </div>
            </div>
        </div>

    </div>
    <!-- #/ container -->
</div>

<!--**********************************
    Content body end
***********************************-->


<!--**********************************
     javascript start
***********************************-->
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script type="text/javascript">
    $(function() {

        //월요일
        var loadForm_mon = function () {
            var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#modal-todo-mon").modal("show");
                },
                success: function (data) {
                    $("#modal-todo-mon .modal-content").html(data.html_form);
                }
            });
        };
        var saveForm_mon = function () {
            var form = $(this);
            $.ajax({
                url: form.attr("action"),
                data: form.serialize(),
                type: form.attr("method"),
                dataType: 'json',
                success: function (data) {
                    if (data.form_is_valid) {
                        $("#todo-table-mon tbody").html(data.html_todo_list);
                        $("#modal-todo-mon").modal("hide");
                    }
                    else {
                        $("#modal-todo-mon .modal-content").html(data.html_form);
                    }
                }
            });
            return false;
        };
        $(".js-create-todo-mon").click(loadForm_mon);
        $("#modal-todo-mon").on("submit", ".js-todo-create-form", saveForm_mon);
        $("#todo-table-mon").on("click", ".js-delete-todo", loadForm_mon);
        $("#modal-todo-mon").on("submit", ".js-todo-delete-form", saveForm_mon);

        //화요일
        var loadForm_tue = function () {
            var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#modal-todo-tue").modal("show");
                },
                success: function (data) {
                    $("#modal-todo-tue .modal-content").html(data.html_form);
                }
            });
        };
        var saveForm_tue = function () {
            var form = $(this);
            $.ajax({
                url: form.attr("action"),
                data: form.serialize(),
                type: form.attr("method"),
                dataType: 'json',
                success: function (data) {
                    if (data.form_is_valid) {
                        $("#todo-table-tue tbody").html(data.html_todo_list);
                        $("#modal-todo-tue").modal("hide");
                    }
                    else {
                        $("#modal-todo-tue .modal-content").html(data.html_form);
                    }
                }
            });
            return false;
        };
        $(".js-create-todo-tue").click(loadForm_tue);
        $("#modal-todo-tue").on("submit", ".js-todo-create-form", saveForm_tue);
        $("#todo-table-tue").on("click", ".js-delete-todo", loadForm_tue);
        $("#modal-todo-tue").on("submit", ".js-todo-delete-form", saveForm_tue);

        //수요일
        var loadForm_wed = function () {
            var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#modal-todo-wed").modal("show");
                },
                success: function (data) {
                    $("#modal-todo-wed .modal-content").html(data.html_form);
                }
            });
        };
        var saveForm_wed = function () {
            var form = $(this);
            $.ajax({
                url: form.attr("action"),
                data: form.serialize(),
                type: form.attr("method"),
                dataType: 'json',
                success: function (data) {
                    if (data.form_is_valid) {
                        $("#todo-table-wed tbody").html(data.html_todo_list);
                        $("#modal-todo-wed").modal("hide");
                    }
                    else {
                        $("#modal-todo-wed .modal-content").html(data.html_form);
                    }
                }
            });
            return false;
        };
        $(".js-create-todo-wed").click(loadForm_wed);
        $("#modal-todo-wed").on("submit", ".js-todo-create-form", saveForm_wed);
        $("#todo-table-wed").on("click", ".js-delete-todo", loadForm_wed);
        $("#modal-todo-wed").on("submit", ".js-todo-delete-form", saveForm_wed);

        //목요일
        var loadForm_thu = function () {
            var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#modal-todo-thu").modal("show");
                },
                success: function (data) {
                    $("#modal-todo-thu .modal-content").html(data.html_form);
                }
            });
        };
        var saveForm_thu = function () {
            var form = $(this);
            $.ajax({
                url: form.attr("action"),
                data: form.serialize(),
                type: form.attr("method"),
                dataType: 'json',
                success: function (data) {
                    if (data.form_is_valid) {
                        $("#todo-table-thu tbody").html(data.html_todo_list);
                        $("#modal-todo-thu").modal("hide");
                    }
                    else {
                        $("#modal-todo-thu .modal-content").html(data.html_form);
                    }
                }
            });
            return false;
        };
        $(".js-create-todo-thu").click(loadForm_thu);
        $("#modal-todo-thu").on("submit", ".js-todo-create-form", saveForm_thu);
        $("#todo-table-thu").on("click", ".js-delete-todo", loadForm_thu);
        $("#modal-todo-thu").on("submit", ".js-todo-delete-form", saveForm_thu);

        //금요일
        var loadForm_fri = function () {
            var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#modal-todo-fri").modal("show");
                },
                success: function (data) {
                    $("#modal-todo-fri .modal-content").html(data.html_form);
                }
            });
        };
        var saveForm_fri = function () {
            var form = $(this);
            $.ajax({
                url: form.attr("action"),
                data: form.serialize(),
                type: form.attr("method"),
                dataType: 'json',
                success: function (data) {
                    if (data.form_is_valid) {
                        $("#todo-table-fri tbody").html(data.html_todo_list);
                        $("#modal-todo-fri").modal("hide");
                    }
                    else {
                        $("#modal-todo-fri .modal-content").html(data.html_form);
                    }
                }
            });
            return false;
        };
        $(".js-create-todo-fri").click(loadForm_fri);
        $("#modal-todo-fri").on("submit", ".js-todo-create-form", saveForm_fri);
        $("#todo-table-fri").on("click", ".js-delete-todo", loadForm_fri);
        $("#modal-todo-fri").on("submit", ".js-todo-delete-form", saveForm_fri);

        //토요일
        var loadForm_sat = function () {
            var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#modal-todo-sat").modal("show");
                },
                success: function (data) {
                    $("#modal-todo-sat .modal-content").html(data.html_form);
                }
            });
        };
        var saveForm_sat = function () {
            var form = $(this);
            $.ajax({
                url: form.attr("action"),
                data: form.serialize(),
                type: form.attr("method"),
                dataType: 'json',
                success: function (data) {
                    if (data.form_is_valid) {
                        $("#todo-table-sat tbody").html(data.html_todo_list);
                        $("#modal-todo-sat").modal("hide");
                    }
                    else {
                        $("#modal-todo-sat .modal-content").html(data.html_form);
                    }
                }
            });
            return false;
        };
        $(".js-create-todo-sat").click(loadForm_sat);
        $("#modal-todo-sat").on("submit", ".js-todo-create-form", saveForm_sat);
        $("#todo-table-sat").on("click", ".js-delete-todo", loadForm_sat);
        $("#modal-todo-sat").on("submit", ".js-todo-delete-form", saveForm_sat);

        //일요일
        var loadForm_sun = function () {
            var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#modal-todo-sun").modal("show");
                },
                success: function (data) {
                    $("#modal-todo-sun .modal-content").html(data.html_form);
                }
            });
        };
        var saveForm_sun = function () {
            var form = $(this);
            $.ajax({
                url: form.attr("action"),
                data: form.serialize(),
                type: form.attr("method"),
                dataType: 'json',
                success: function (data) {
                    if (data.form_is_valid) {
                        $("#todo-table-sun tbody").html(data.html_todo_list);
                        $("#modal-todo-sun").modal("hide");
                    }
                    else {
                        $("#modal-todo-sun .modal-content").html(data.html_form);
                    }
                }
            });
            return false;
        };
        $(".js-create-todo-sun").click(loadForm_sun);
        $("#modal-todo-sun").on("submit", ".js-todo-create-form", saveForm_sun);
        $("#todo-table-sun").on("click", ".js-delete-todo", loadForm_sun);
        $("#modal-todo-sun").on("submit", ".js-todo-delete-form", saveForm_sun);
    });


    $(".complete").click(function(){
            pk = $(this).attr("data-id");
            $.ajax({
                type:"POST",
                url: $(this).attr("data-url"),
                data: {'csrfmiddlewaretoken':'{{ csrf_token }}'},
                dataType: "json",
                success: function(data){
                    // $("#todo-table-mon tbody").html(data.html_todo_list);
                    window.location.href = "{% url 'index' %}"
                }
            });
    });

</script>
<!--**********************************
     javascript end
***********************************-->
{% endblock %}